<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Signup</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    
    <div class="container">
        <!-- Back Arrow Button -->
        <div class="back-arrow" onclick="window.location.href='teacher.html'">
            <i class="fas fa-arrow-left"></i>
            <span>Back to Login</span>
        </div>

        <!-- Step 1: Basic Information -->
        <div id="step1" class="form-container">
            <h1>Teacher Signup</h1>
            <p class="form-description">Step 1: Basic Information</p>
            
            <form id="signupForm" onsubmit="handleNextStep(event)">
                
                <p class="form-description">Create your account to apply as a teacher</p>
            
            
                <div class="form-group">
                    <input type="text" id="fullName" required>
                    <label for="fullName">Full Name</label>
                </div>

                <div class="form-group">
                    <input type="email" id="email" required>
                    <label for="email">Email Address</label>
                </div>

                <div class="form-group">
                    <input type="tel" id="phone" required>
                    <label for="phone">Phone Number</label>
                </div>

                <div class="form-group address-group">
                    <input type="text" id="address" required autocomplete="off">
                    <label for="address">Full Address</label>
                    <div id="addressSuggestions" class="address-suggestions"></div>
                    <div id="map" class="address-map"></div>
                    <small class="map-hint">After selecting a location, you can click on the map to set your exact address</small>
                </div>
                
                <div class="form-group">
                    <select id="grade" onchange="updateSubjects()" required>
                        <option value="" disabled selected>Select Grade</option>
                        <option value="1">Grade 1</option>
                        <option value="2">Grade 2</option>
                        <option value="3">Grade 3</option>
                        <option value="4">Grade 4</option>
                        <option value="5">Grade 5</option>
                        <option value="6">Grade 6</option>
                        <option value="7">Grade 7</option>
                        <option value="8">Grade 8</option>
                        <option value="9">Grade 9</option>
                        <option value="10">Grade 10</option>
                        <option value="11">Grade 11</option>
                        <option value="12">Grade 12</option>
                    </select>
                    <label for="grade">Select the highest class you can teach</label>
                </div>
                
                <div class="form-group subjects-group">
                    <label class="subjects-label">Select Subjects You Can Teach</label>
                    <div id="subjectGrid" class="subjects-grid">
                        <!-- Subjects will be dynamically populated here -->
                    </div>
                </div>

                <div class="form-group">
                    <input type="password" id="password" required>
                    <label for="password">Create Password</label>
                </div>

                <div class="form-group">
                    <input type="password" id="confirmPassword" required>
                    <label for="confirmPassword">Confirm Password</label>
                </div>

                <button type="submit" class="submit-btn">
                    <span>Next</span>
                    <i class="fas fa-arrow-right"></i>
                </button>

                <div class="form-links">
                    <a href="teacher.html" class="login-link">
                        <i class="fas fa-sign-in-alt"></i> Already have an account? Login
                    </a>
                </div>
            </form>
        </div>

        <div id="step2" class="form-container" style="display: none;">
            <h1>Upload CV</h1>
            <p class="form-description">Step 2: Upload your CV and additional documents</p>
        
            <form id="cvForm" onsubmit="handleSignup(event)">
                <!-- CV Upload -->
               <!-- Replace your existing upload container HTML -->
<div class="upload-container">
    <div class="upload-box">
        <input type="file" id="cv" accept=".pdf,.doc,.docx" required>
        <label for="cv">
            <i class="fas fa-file-upload"></i>
            <span>Choose CV (PDF, DOC, DOCX) (2MB max)</span>
        </label>
        <div id="cvFileName" class="file-name"></div>
    </div>
</div>

<div class="upload-container">
    <div class="upload-box">
        <input type="file" id="certificates" accept=".pdf,.doc,.docx" multiple>
        <label for="certificates">
            <i class="fas fa-certificate"></i>
            <span>Additional Certificates (Optional)</span>
        </label>
        <div id="certificateFiles" class="file-name"></div>
    </div>
</div>

        <div class="terms-container">
            <h3 class="terms-title">Terms and Conditions</h3>
            <div class="terms-box">
                <div class="terms-content">
                    <h4>Teacher Application Terms:</h4>
                    <ol>
                        <li>I hereby declare that all the information provided in this application is true and correct.</li>
                        <li>I understand that any false statements may result in the rejection of my application.</li>
                        <li>I agree to:</li>
                        <ul>
                            <li>Provide high-quality teaching tailored to the needs of the student(s)</li>
                            <li>Be punctual and professional in all interactions</li>
                            <li>Maintain confidentiality of all student-related information</li>
                            <li>Report progress to the Company or parents, as required</li>
                        </ul>
                        <li>I agree to <b>pay 30% </b>of the first month's tuition fee to the Company before commencing teaching.</li>
                        <li>I agree not to disclose any confidential information regarding the Company, students, or parents without prior consent from the Company.  </li>
                        <li>I agree to conduct myself in a lawful, ethical, and professional manner at all times during my teaching assignments.</li>
                        <li>Any crime, illegal activity, or misconduct committed by me during the course of my teaching duties will be solely my responsibility. The Company shall not be held liable for such actions.</li>
                        <li>I agree to abide by the Company's code of conduct, including but not limited to:</li>
                        <ul>
                            <li>Maintaining a respectful and safe environment for students</li>
                            <li>Avoiding conflicts of interest or private agreements with clients</li>
                        </ul>
                    </ol>
                </div>
            </div>
            
            <div class="terms-acceptance">
                <input type="checkbox" id="acceptTerms" required>
                <label for="acceptTerms">I have read and agree to the terms and conditions</label>
            </div>
        </div>

        <!-- Add this right before the confirmation-container div -->
        <div class="download-agreement">
            <p class="download-text">Please download and review the agreement before proceeding</p>
            <button type="button" onclick="downloadAgreement()" class="download-btn" id="downloadBtn">
                <i class="fas fa-file-download"></i>
                Download Agreement
            </button>
            <div class="download-status">
                <input type="checkbox" id="confirmDownload" required>
                <label for="confirmDownload">I have downloaded and reviewed the agreement</label>
            </div>
        </div>

        <div class="confirmation-container">
            <h3 class="confirmation-title">Digital Confirmation</h3>
            <p class="confirmation-subtitle">By typing your full name below, you confirm your agreement to the above terms</p>
            
            <div class="form-group">
                <input type="text" id="confirmationName" required>
                <label for="confirmationName">Type your full name</label>
            </div>
            <p class="confirmation-hint">Please type your full name exactly as entered above</p>
        </div>



        <div class="button-group">
            <button type="button" onclick="showStep(1)" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                <span>Back</span>
            </button>
            <button type="submit" class="submit-btn">
                <span>Create Account</span>
                <i class="fas fa-user-plus"></i>
            </button>
        </div>
    </form>
</div>


<!-- Add Leaflet CSS and JS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>







<!-- Add these styles -->
<style>
    .terms-container {
        margin-bottom: 30px;
    }

    .terms-title {
        color: #333;
        margin-bottom: 15px;
        font-size: 1.1em;
    }

    .terms-box {
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background: #f8f9fa;
        margin-bottom: 15px;
        max-height: 300px;
        overflow-y: auto;
    }

    .terms-content {
        color: #444;
        font-size: 14px;
        line-height: 1.6;
    }

    .terms-content h4 {
        margin-bottom: 10px;
        color: #333;
    }

    .terms-content ol {
        padding-left: 20px;
        margin-bottom: 10px;
    }

    .terms-content ul {
        padding-left: 40px;
        margin: 5px 0;
    }

    .terms-content li {
        margin-bottom: 8px;
    }

    .terms-acceptance {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 15px;
    }

    .terms-acceptance input[type="checkbox"] {
        width: auto;
        margin-right: 10px;
    }

    .terms-acceptance label {
        position: static;
        color: #333;
        font-size: 14px;
        background: none;
        padding: 0;
        cursor: pointer;
    }

    .confirmation-container {
        margin: 30px 0;
    }

    .confirmation-title {
        color: #333;
        margin-bottom: 10px;
        font-size: 1.1em;
    }

    .confirmation-subtitle {
        color: #666;
        font-size: 14px;
        margin-bottom: 20px;
    }

    .confirmation-hint {
        color: #666;
        font-size: 13px;
        margin-top: 5px;
    }

    .download-agreement {
        margin: 30px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #e9ecef;
    }

    .download-text {
        color: #495057;
        margin-bottom: 15px;
        font-size: 14px;
    }

    .download-btn {
        background: #43cea2;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 15px;
        transition: all 0.3s ease;
    }

    .download-btn:hover {
        background: #3ab793;
    }

    .download-btn i {
        font-size: 16px;
    }

    .download-status {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 10px;
    }

    .download-status input[type="checkbox"] {
        width: 18px;
        height: 18px;
    }

    .download-status label {
        color: #495057;
        font-size: 14px;
    }



    /* Update your existing signature styles if needed */
</style>


    

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #43cea2, #185a9d);
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .form-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .form-description {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }
        
        .form-group {
            position: relative;
            margin-bottom: 25px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
        }
        
        .form-group label {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            padding: 0 5px;
            color: #666;
            font-size: 16px;
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #43cea2;
            outline: none;
        }
        
        .form-group input:focus ~ label,
        .form-group input:valid ~ label,
        .form-group select:focus ~ label,
        .form-group select:valid ~ label {
            top: 0;
            font-size: 14px;
            color: #43cea2;
            transform: translateY(-50%);
        }
        
        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #43cea2, #185a9d);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .back-arrow {
            position:relative;
            padding: 7px 10px;
            margin: 1px;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .back-arrow:hover {
            transform: translateX(-5px);
        }
        
        .form-links {
            margin-top: 20px;
            text-align: center;
        }
        
        .form-links a {
            color: #185a9d;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .form-links a:hover {
            color: #43cea2;
        }

        .file-upload {
            margin-bottom: 30px;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: #f5f5f5;
            border: 2px dashed #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-label:hover {
            border-color: #43cea2;
            background: #f0f9f6;
        }

        .file-name, .selected-files {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .button-group .back-btn {
            flex: 1;
            padding: 15px;
            background: #f5f5f5;
            color: #666;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .button-group .back-btn:hover {
            background: #e5e5e5;
        }

        .button-group .submit-btn {
            flex: 2;
        }



.upload-box {
    border: 2px dashed #ddd;
    border-radius: 8px;
    padding: 20px;
    text-align: center;
    background: #f8f9fa;
    transition: all 0.3s ease;
    position: relative; /* Add this */
    cursor: pointer;
}

.upload-box:hover {
    border-color: #43cea2;
    background: #f0f9f6;
}

.upload-box input[type="file"] {
    position: absolute; /* Change from display: none */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    cursor: pointer;
    z-index: 2;
}

.upload-box label {
    display: block;
    position: relative; /* Change from static */
    background: transparent;
    pointer-events: none; /* Add this */
    z-index: 1;
    padding: 20px;
    margin: 0;
}

.upload-box label i {
    font-size: 24px;
    color: #43cea2;
    margin-bottom: 10px;
    display: block;
}

.upload-box label span {
    color: #666;
    font-size: 16px;
    display: block;
    margin-top: 10px;
}
        
        @media (max-width: 768px) {
            .form-container {
                padding: 20px;
            }
        
            h1 {
                font-size: 2em;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 20px 10px;
            }
        
            h1 {
                font-size: 1.8em;
            }
        
            .form-description {
                font-size: 14px;
            }
        
            .submit-btn {
                font-size: 16px;
            }
        }
    </style>

<style>
    
  /* subjects */


/* Subject Selection Styles */
.subjects-group {
    margin-top: 30px;
}

.subjects-label {
    display: block;
    color: #333;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
    position: static !important;
}

.subjects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    padding: 15px;
    background: #f8f9fa;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
}

.subject-item {
    position: relative;
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    transition: all 0.3s ease;
}

.subject-item input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
    z-index: 2;
}

.subject-item label {
    display: flex;
    align-items: center;
    padding: 12px 15px;
    background: white;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    color: #555;
    position: relative;
    z-index: 1;
    margin: 0;
    width: 100%;
    font-weight: 500;
}

.subject-item label i {
    margin-right: 10px;
    font-size: 16px;
    min-width: 20px;
    color: #666;
}

/* Selected state */
.subject-item input[type="checkbox"]:checked + label {
    background: #43cea2;
    color: white;
}

.subject-item input[type="checkbox"]:checked + label i {
    color: white;
}

/* Hover state */
.subject-item:hover {
    border-color: #43cea2;
    transform: translateY(-2px);
}

/* Stream Layout Styles */
.stream-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 15px;
    display: flex;
}

.stream-column {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.stream-title {
    color: #185a9d;
    font-size: 1.1em;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 2px solid #43cea2;
}

.stream-subjects {
    display: grid;
    gap: 10px;
}

/* Responsive Design */
@media (max-width: 768px) {
    .stream-container {
        grid-template-columns: 1fr;
        display: grid;
    }

    .subjects-grid {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    }

    .subject-item label {
        padding: 10px 12px;
        font-size: 14px;
    }
}

/* Grade Select Specific Styles */
select#grade {
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 15px center;
    background-size: 12px;
    padding-right: 40px;
}

select#grade:focus {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2343cea2' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
}

/* Fix for select label */
.form-group select:valid ~ label {
    top: 0;
    font-size: 14px;
    color: #43cea2;
    transform: translateY(-50%);
    background: white;
    padding: 0 5px;
}

.address-group {
    position: relative;
}

.address-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    margin-top: 5px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 1000;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    display: none;
}

.suggestion-item {
    padding: 12px 15px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
    transition: all 0.2s ease;
}

.suggestion-item:hover {
    background: #f0f8ff;
}

.location-name {
    font-weight: 500;
    color: #333;
}

.location-detail {
    font-size: 12px;
    color: #666;
    margin-top: 4px;
}

.address-map {
    height: 300px;
    margin-top: 10px;
    border-radius: 8px;
    display: none;
    border: 1px solid #ddd;
}

.map-hint {
    color: #666;
    font-size: 12px;
    margin-top: 5px;
    display: none;
}

/* Loading indicator */
.loading-spinner {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid #43cea2;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-left: 10px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

.location-type {
    font-size: 11px;
    color: #666;
    margin-top: 2px;
    font-style: italic;
}

.suggestion-item {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background-color 0.2s;
}

.suggestion-item:hover {
    background-color: #f5f5f5;
}
</style>

<style>
.map-notification {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    z-index: 1000;
    animation: fadeInOut 3s forwards;
}

@keyframes fadeInOut {
    0% { opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { opacity: 0; }
}
</style>

<script>
    // Form data storage
    let formData = {};

    const API_BASE_URL = 'http://localhost:5000/api/teacher-apply';

    // Utility function to handle API responses
    async function handleApiResponse(response) {
        if (!response.ok) {
            const errorData = await response.json().catch(() => null);
            throw new Error(errorData?.message || `HTTP error! status: ${response.status}`);
        }
        return response.json();
    }

    function getSubjectIcon(subject) {
        const icons = {
            'Math': 'fas fa-square-root-alt',
            'Science': 'fas fa-flask',
            'Samajik': 'fas fa-globe',
            'Opt. Math': 'fas fa-calculator',
            'Account': 'fas fa-book',
            'Computer': 'fas fa-laptop',
            'Nepali': 'fas fa-language',
            'English': 'fas fa-book-open',
            'Other': 'fas fa-shapes',
            'All Guidance': 'fas fa-chalkboard-teacher',
            'Physics': 'fas fa-atom',
            'Chemistry': 'fas fa-vial',
            'Mathematics': 'fas fa-square-root-alt',
            'Economics': 'fas fa-chart-line',
            'Business Math': 'fas fa-calculator',
            'Social': 'fas fa-users',
            'Others': 'fas fa-ellipsis-h'
        };
        return icons[subject] || 'fas fa-book';
    }

    function renderSubjectCards(subjects, container) {
        container.innerHTML = ''; // Clear existing subjects
        subjects.forEach(subject => {
            const subjectItem = document.createElement('div');
            subjectItem.className = 'subject-item';
            subjectItem.innerHTML = `
                <input type="checkbox" id="${subject.toLowerCase()}" 
                       value="${subject}" class="subject-checkbox">
                <label for="${subject.toLowerCase()}">
                    <i class="${getSubjectIcon(subject)}"></i>
                    ${subject}
                </label>
            `;
            container.appendChild(subjectItem);
        });
    }

    function updateSubjects() {
        const grade = parseInt(document.getElementById('grade').value);
        const subjectGrid = document.getElementById('subjectGrid');
        
        // Clear existing subjects
        subjectGrid.innerHTML = '';
        
        if (grade >= 1 && grade <= 10) {
            const subjects = [
                'Math', 'Science', 'Samajik', 'Opt. Math', 'Account',
                'Computer', 'Nepali', 'English', 'Other', 'All Guidance'
            ];
            renderSubjectCards(subjects, subjectGrid);
        } 
        else if (grade === 11 || grade === 12) {
            subjectGrid.innerHTML = `
                <div class="stream-container">
                    <div class="stream-column">
                        <h3 class="stream-title">Science</h3>
                        <div class="stream-subjects" id="scienceSubjects"></div>
                    </div>
                    <div class="stream-column">
                        <h3 class="stream-title">Management</h3>
                        <div class="stream-subjects" id="managementSubjects"></div>
                    </div>
                </div>
            `;

            const scienceSubjects = [
                'Physics', 'Chemistry', 'Mathematics', 'English',
                'Nepali', 'Computer', 'Social', 'All Guidance'
            ];
            const managementSubjects = [
                'Account', 'Economics', 'Business Math', 'English',
                'Nepali', 'Computer', 'Social', 'All Guidance'
            ];

            renderSubjectCards(scienceSubjects, document.getElementById('scienceSubjects'));
            renderSubjectCards(managementSubjects, document.getElementById('managementSubjects'));
        }
    }


    function handleNextStep(event) {
        event.preventDefault();
        
        const selectedSubjects = Array.from(document.querySelectorAll('.subject-checkbox:checked'))
            .map(checkbox => checkbox.value);
        
        if (selectedSubjects.length === 0) {
            alert('Please select at least one subject');
            return;
        }
        
        formData = {
            fullName: document.getElementById('fullName').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            password: document.getElementById('password').value,
            subjects: selectedSubjects,
            grade: document.getElementById('grade').value,
            address: document.getElementById('address').value
        };

        console.log('Form data stored:', formData);
        showStep(2);
    }

        
        // File size limits
        const FILE_SIZE_LIMITS = {
            CV: 2 * 1024 * 1024,        // 2MB in bytes
            CERTIFICATE: 2 * 1024 * 1024 // 2MB in bytes
        };
        
        // Utility functions
        function validateFileSize(file, limit) {
            return file.size <= limit;
        }
        
        function showStep(step) {
            document.getElementById('step1').style.display = step === 1 ? 'block' : 'none';
            document.getElementById('step2').style.display = step === 2 ? 'block' : 'none';
        }
        
        // Handle step 1 submission
        async function handleNextStep(event) {
            event.preventDefault();
        
            // Get form values
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
        
            // Get selected subjects
            const selectedSubjects = Array.from(document.querySelectorAll('.subject-checkbox:checked'))
                .map(checkbox => checkbox.value);
        
            // Validations
            if (!fullName) {
                alert('Please enter your full name');
                return;
            }
        
            if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                alert('Please enter a valid email address');
                return;
            }
        
            if (!phone || !/^\d{10}$/.test(phone)) {
                alert('Please enter a valid 10-digit phone number');
                return;
            }
        
            if (selectedSubjects.length === 0) {
                alert('Please select at least one subject');
                return;
            }
        
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
        
            if (password.length < 6) {
                alert('Password must be at least 6 characters long');
                return;
            }
        
            // Store form data
            formData = {
                fullName,
                email,
                phone,
                password,
                subjects: selectedSubjects,
                grade: document.getElementById('grade').value,
                address: document.getElementById('address').value
            };
        
            console.log('Form data stored:', formData);
            showStep(2);
        }
        
        // Handle final signup
        async function handleSignup(event) {
        event.preventDefault();
        console.log('Handling signup...');

        // Update button state
        const submitButton = event.target.querySelector('button[type="submit"]');
        submitButton.disabled = true;
        submitButton.innerHTML = '<span>Creating Account...</span><i class="fas fa-spinner fa-spin"></i>';

        try {
            // Validate coordinates
            if (!selectedLatitude || !selectedLongitude) {
                throw new Error('Please select your location on the map');
            }

            // Check terms acceptance
            if (!document.getElementById('acceptTerms').checked) {
                throw new Error('Please accept the terms and conditions');
            }

            // Get files
            const cvFile = document.getElementById('cv').files[0];
            if (!cvFile) {
                throw new Error('Please upload your CV');
            }

            // Create FormData and append all data
            const submitFormData = new FormData();
            submitFormData.append('fullName', formData.fullName);
            submitFormData.append('email', formData.email);
            submitFormData.append('phone', formData.phone);
            submitFormData.append('password', formData.password);
            submitFormData.append('grade', formData.grade);
            submitFormData.append('subjects', JSON.stringify(formData.subjects));
            submitFormData.append('address', document.getElementById('address').value);
            submitFormData.append('latitude', selectedLatitude.toString());
            submitFormData.append('longitude', selectedLongitude.toString());
            submitFormData.append('agreementAccepted', 'true');

            // Append CV file
            submitFormData.append('cv', cvFile);

            // Send request to server
            const response = await fetch('http://localhost:5000/api/teacher-apply/signup', {
                method: 'POST',
                body: submitFormData,
                // Remove any headers that might interfere with FormData
            });

            // Check if the response is ok before trying to parse JSON
            if (!response.ok) {
                const errorData = await response.json().catch(() => null);
                throw new Error(errorData?.message || `HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            if (data.success) {
                alert('Registration successful! Please login to continue.');
                window.location.href = 'teacher.html';
            } else {
                throw new Error(data.message || 'Registration failed');
            }

        } catch (error) {
            console.error('Signup Error:', error);
            alert(`Error creating account: ${error.message}`);
        } finally {
            // Always reset button state
            submitButton.disabled = false;
            submitButton.innerHTML = '<span>Create Account</span><i class="fas fa-user-plus"></i>';
        }
    }
        
        // File input event listeners
        document.getElementById('cv').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                if (!validateFileSize(file, FILE_SIZE_LIMITS.CV)) {
                    alert('CV file size must be less than 2MB');
                    this.value = '';
                    document.getElementById('cvFileName').textContent = '';
                    return;
                }
                document.getElementById('cvFileName').textContent = 
                    `${file.name} (${(file.size / (1024 * 1024)).toFixed(2)}MB)`;
            }
        });
        
        document.getElementById('certificates').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            let validFiles = true;
        
            files.forEach(file => {
                if (!validateFileSize(file, FILE_SIZE_LIMITS.CERTIFICATE)) {
                    alert(`Certificate "${file.name}" must be less than 2MB`);
                    validFiles = false;
                }
            });
        
            if (!validFiles) {
                this.value = '';
                document.getElementById('certificateFiles').textContent = '';
                return;
            }
        
            if (files.length) {
                document.getElementById('certificateFiles').textContent = files
                    .map(file => `${file.name} (${(file.size / (1024 * 1024)).toFixed(2)}MB)`)
                    .join(', ');
            }
        });

    // Debounce function
    function debounce(func, wait) {
        let timeout;
        return function(...args) {
            clearTimeout(timeout);
            timeout = setTimeout(() => func.apply(this, args), wait);
        };
    }

    // Initialize map and address search
    let map = null;
    let marker = null;

    // Add these variables at the top with your other global variables
    let selectedLatitude = null;
    let selectedLongitude = null;

    function initMap() {
        // Center of Kathmandu Valley
        const kathmandu = [27.7172, 85.3240];
        
        map = L.map('map').setView(kathmandu, 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Add click event to map
        map.on('click', function(e) {
            if (marker) {
                map.removeLayer(marker);
            }
            marker = L.marker(e.latlng).addTo(map);
            selectedLatitude = e.latlng.lat;
            selectedLongitude = e.latlng.lng;
            
            // Update the address input with coordinates
            document.getElementById('address').value = `${document.getElementById('address').value} (${selectedLatitude.toFixed(6)}, ${selectedLongitude.toFixed(6)})`;
        });
    }

    const predefinedLocations = [
        // Kathmandu
        
        { "name": "Thamel", "district": "Kathmandu", "area": "Thamel", "lat": 27.7145, "lon": 85.3129 },
        { "name": "New Road", "district": "Kathmandu", "area": "City Center", "lat": 27.7047, "lon": 85.3189 },
        { "name": "Durbarmarg", "district": "Kathmandu", "area": "City Center", "lat": 27.7106, "lon": 85.3223 },
        { "name": "Lazimpat", "district": "Kathmandu", "area": "North Kathmandu", "lat": 27.7246, "lon": 85.3249 },
        { "name": "Pashupati", "district": "Kathmandu", "area": "Pashupati Area", "lat": 27.7112, "lon": 85.3499 },
        { "name": "Swoyambhu", "district": "Kathmandu", "area": "Swoyambhu Hill", "lat": 27.7150, "lon": 85.2905 },
        { "name": "Boudha", "district": "Kathmandu", "area": "Boudha", "lat": 27.7202, "lon": 85.3584 },
        { "name": "Chabahil", "district": "Kathmandu", "area": "Chabahil", "lat": 27.7234, "lon": 85.3478 },
        { "name": "Koteshwor", "district": "Kathmandu", "area": "Koteshwor", "lat": 27.6788, "lon": 85.3476 },
         { "name": "Gongabu", "district": "Kathmandu", "area": "Gongabu", "lat": 27.7391, "lon": 85.3105 },
        { "name": "Balaju", "district": "Kathmandu", "area": "Balaju", "lat": 27.7358, "lon": 85.3014 },
        { "name": "Banasthali", "district": "Kathmandu", "area": "Banasthali", "lat": 27.7340, "lon": 85.2872 },
        { "name": "Raniban", "district": "Kathmandu", "area": "Northwest Kathmandu", "lat": 27.7340, "lon": 85.2647 },
        { "name": "Kalanki", "district": "Kathmandu", "area": "Kalanki", "lat": 27.6934, "lon": 85.2806 },
         { "name": "Maitighar", "district": "Kathmandu", "area": "City Center", "lat": 27.6966, "lon": 85.3204 },
        { "name": "Baneshwor", "district": "Kathmandu", "area": "Baneshwor", "lat": 27.6937, "lon": 85.3343 },
        { "name": "Jamal", "district": "Kathmandu", "area": "City Center", "lat": 27.7084, "lon": 85.3183 },
        { "name": "Ratna Park", "district": "Kathmandu", "area": "City Center", "lat": 27.7040, "lon": 85.3154 },
        { "name": "Putalisadak", "district": "Kathmandu", "area": "City Center", "lat": 27.6998, "lon": 85.3220 },
        { "name": "Gaushala", "district": "Kathmandu", "area": "Pashupati Area", "lat": 27.7095, "lon": 85.3520 },
            { "name": "Tripureshwor", "district": "Kathmandu", "area": "Tripureshwor", "lat": 27.6973, "lon": 85.3132 },
        { "name": "Teku", "district": "Kathmandu", "area": "Teku", "lat": 27.6959, "lon": 85.3045 },
            { "name": "Kumaripati", "district": "Lalitpur", "area": "Patan", "lat": 27.6736, "lon": 85.3170 },
        { "name": "Jawalakhel", "district": "Lalitpur", "area": "Patan", "lat": 27.6700, "lon": 85.3143 },
        { "name": "Kupondole", "district": "Lalitpur", "area": "Patan", "lat": 27.6826, "lon": 85.3177 },
           { "name": "Sanepa", "district": "Lalitpur", "area": "Sanepa", "lat": 27.6842, "lon": 85.3078 },
        { "name": "Maharajgunj", "district": "Kathmandu", "area": "North Kathmandu", "lat": 27.7335, "lon": 85.3378 },
        { "name": "Budhanilkantha", "district": "Kathmandu", "area": "North Kathmandu", "lat": 27.7683, "lon": 85.3544 },
        { "name": "Chapagaun", "district": "Lalitpur", "area": "Chapagaun", "lat": 27.5955, "lon": 85.3235 },
        { "name": "Imadol", "district": "Lalitpur", "area": "Imadol", "lat": 27.6595, "lon": 85.3447 },
        { "name": "Sitapaila", "district": "Kathmandu", "area": "Sitapaila", "lat": 27.7215, "lon": 85.2744 },
         { "name": "Thankot", "district": "Kathmandu", "area": "Thankot", "lat": 27.7004, "lon": 85.2471 },
        { "name": "Naya Bazar", "district": "Kathmandu", "area": "Naya Bazar", "lat": 27.7108, "lon": 85.3047 },
        { "name": "Purano Baneshwor", "district": "Kathmandu", "area": "Baneshwor", "lat": 27.6962, "lon": 85.3413 },
        { "name": "Minbhawan", "district": "Kathmandu", "area": "Baneshwor", "lat": 27.6902, "lon": 85.3403 },
        { "name": "Tinkune", "district": "Kathmandu", "area": "Koteshwor", "lat": 27.6756, "lon": 85.3449 },
        { "name": "Gothatar", "district": "Kathmandu", "area": "Gothatar", "lat": 27.6810, "lon": 85.3954 },
          { "name": "Jorpati", "district": "Kathmandu", "area": "Jorpati", "lat": 27.7274, "lon": 85.3657 },
        { "name": "Kapan", "district": "Kathmandu", "area": "Kapan", "lat": 27.7482, "lon": 85.3701 },
        { "name": "Dhapasi", "district": "Kathmandu", "area": "Dhapasi", "lat": 27.7448, "lon": 85.3267 },
         { "name": "Golfutar", "district": "Kathmandu", "area": "Budhanilkantha", "lat": 27.7545, "lon": 85.3515 },
        { "name": "Hattigauda", "district": "Kathmandu", "area": "Budhanilkantha", "lat": 27.7588, "lon": 85.3779 },
       { "name": "Handigaun", "district": "Kathmandu", "area": "Handigaun", "lat": 27.7284, "lon": 85.3456 },
       { "name": "Bhaisepati", "district": "Lalitpur", "area": "Bhaisepati", "lat": 27.6651, "lon": 85.2915 },
       { "name": "Khumaltar", "district": "Lalitpur", "area": "Khumaltar", "lat": 27.6646, "lon": 85.3084 },
       { "name": "Balkhu", "district": "Kathmandu", "area": "Balkhu", "lat": 27.6931, "lon": 85.2895 },
       { "name": "Naikap", "district": "Kathmandu", "area": "Naikap", "lat": 27.6905, "lon": 85.2697 },
       { "name": "Sorakhutte", "district": "Kathmandu", "area": "Sorakhutte", "lat": 27.7111, "lon": 85.3008 },
       { "name": "Kalimati", "district": "Kathmandu", "area": "Kalimati", "lat": 27.6951, "lon": 85.3005 },
      { "name": "Bijulibazar", "district": "Kathmandu", "area": "Bijulibazar", "lat": 27.6924, "lon": 85.3349 },
        { "name": "Sinamangal", "district": "Kathmandu", "area": "Sinamangal", "lat": 27.6864, "lon": 85.3497 },
          { "name": "Gairidhara", "district": "Kathmandu", "area": "City Center", "lat": 27.7100, "lon": 85.3235 },
     { "name": "Kamalpokhari", "district": "Kathmandu", "area": "City Center", "lat": 27.7109, "lon": 85.3290 },
          { "name": "Anamnagar", "district": "Kathmandu", "area": "City Center", "lat": 27.6995, "lon": 85.3277 },
     { "name": "Bagbazar", "district": "Kathmandu", "area": "City Center", "lat": 27.7089, "lon": 85.3171 },
    { "name": "Dillibazar", "district": "Kathmandu", "area": "Dillibazar", "lat": 27.7104, "lon": 85.3350 },
    { "name": "Ghattekulo", "district": "Kathmandu", "area": "Dillibazar", "lat": 27.7029, "lon": 85.3334 },
        { "name": "Babarmahal", "district": "Kathmandu", "area": "Babarmahal", "lat": 27.6917, "lon": 85.3216 },
        { "name": "Sundhara", "district": "Kathmandu", "area": "Sundhara", "lat": 27.7024, "lon": 85.3167 },
         { "name": "Thapathali", "district": "Kathmandu", "area": "Thapathali", "lat": 27.6935, "lon": 85.3170 },
        { "name": "Teku Thapathali", "district": "Kathmandu", "area": "Teku", "lat": 27.6949, "lon": 85.3088 },
        { "name": "Bhrikuti Mandap", "district": "Kathmandu", "area": "Exhibition Road", "lat": 27.7014, "lon": 85.3194 },
        { "name": "Exhibition Road", "district": "Kathmandu", "area": "Exhibition Road", "lat": 27.7003, "lon": 85.3205 },
        { "name": "Pulchowk", "district": "Lalitpur", "area": "Patan", "lat": 27.6800, "lon": 85.3148 },
         { "name": "Gwarko", "district": "Lalitpur", "area": "Gwarko", "lat": 27.6625, "lon": 85.3279 },
        { "name": "Ekantakuna", "district": "Lalitpur", "area": "Ekantakuna", "lat": 27.6828, "lon": 85.3093 },
        { "name": "Satdobato", "district": "Lalitpur", "area": "Satdobato", "lat": 27.6638, "lon": 85.3179 },
            { "name": "Naxal", "district": "Kathmandu", "area": "Naxal", "lat": 27.7177, "lon": 85.3291 },
      { "name": "Kamaladi", "district": "Kathmandu", "area": "City Center", "lat": 27.7118, "lon": 85.3250 },
        { "name": "Jyatha", "district": "Kathmandu", "area": "Jyatha", "lat": 27.7092, "lon": 85.3144 },
        { "name": "Ason", "district": "Kathmandu", "area": "City Center", "lat": 27.7077, "lon": 85.3117 },
        { "name": "Indrachowk", "district": "Kathmandu", "area": "City Center", "lat": 27.7089, "lon": 85.3127 },
      { "name": "Bangemuda", "district": "Kathmandu", "area": "City Center", "lat": 27.7093, "lon": 85.3110 },
       { "name": "Teendhara", "district": "Kathmandu", "area": "City Center", "lat": 27.7085, "lon": 85.3103 },
        { "name": "Hanumandhoka", "district": "Kathmandu", "area": "City Center", "lat": 27.7057, "lon": 85.3117 },
        { "name": "Machhendrapokhari", "district": "Kathmandu", "area": "City Center", "lat": 27.7080, "lon": 85.3068 },
     { "name": "Lagankhel", "district": "Lalitpur", "area": "Patan", "lat": 27.6726, "lon": 85.3210 },
        { "name": "Basantapur", "district": "Kathmandu", "area": "City Center", "lat": 27.7031, "lon": 85.3115 },
        { "name": "Thahiti", "district": "Kathmandu", "area": "Thahiti", "lat": 27.7073, "lon": 85.3053 },
       { "name": "Nardevi", "district": "Kathmandu", "area": "Nardevi", "lat": 27.7063, "lon": 85.3090 },
       { "name": "Mahaboudha", "district": "Kathmandu", "area": "Mahaboudha", "lat": 27.7058, "lon": 85.3128 },
        { "name": "Ombahal", "district": "Kathmandu", "area": "City Center", "lat": 27.7055, "lon": 85.3109 },
      { "name": "Tengal", "district": "Kathmandu", "area": "Tengal", "lat": 27.7065, "lon": 85.3057 },
        { "name": "Maru", "district": "Kathmandu", "area": "Maru", "lat": 27.7055, "lon": 85.3126 },
        { "name": "Pyaphal", "district": "Kathmandu", "area": "Pyaphal", "lat": 27.7064, "lon": 85.3108 },
        { "name": "Khichapokhari", "district": "Kathmandu", "area": "City Center", "lat": 27.7045, "lon": 85.3142 },
        { "name": "Dharma Path", "district": "Kathmandu", "area": "City Center", "lat": 27.7031, "lon": 85.3182 },
        { "name": "Nagpokhari", "district": "Kathmandu", "area": "City Center", "lat": 27.7083, "lon": 85.3281 },
       { "name": "Tangal", "district": "Kathmandu", "area": "Tangal", "lat": 27.7158, "lon": 85.3210 },
      { "name": "Chhetrapati", "district": "Kathmandu", "area": "Chhetrapati", "lat": 27.7139, "lon": 85.3099 },
         { "name": "Kuleshwor", "district": "Kathmandu", "area": "Kuleshwor", "lat": 27.6859, "lon": 85.3030 },
        { "name": "Pharping", "district": "Kathmandu", "area": "Pharping", "lat": 27.6508, "lon": 85.2512 },
         { "name": "Matatirtha", "district": "Kathmandu", "area": "Matatirtha", "lat": 27.6815, "lon": 85.2579 },
       { "name": "Kirtipur", "district": "Kathmandu", "area": "Kirtipur", "lat": 27.6868, "lon": 85.2809 },
        { "name": "Shankhamul", "district": "Kathmandu", "area": "Shankhamul", "lat": 27.6925, "lon": 85.3407 },
      { "name": "Bhimsengola", "district": "Kathmandu", "area": "Bhimsengola", "lat": 27.6916, "lon": 85.3525 },
         { "name": "Duwakot", "district": "Bhaktapur", "area": "Duwakot", "lat": 27.6945, "lon": 85.4434 },
     { "name": "Dhobighat", "district": "Lalitpur", "area": "Dhobighat", "lat": 27.6784, "lon": 85.3266 },
          { "name": "Bafal", "district": "Kathmandu", "area": "Bafal", "lat": 27.7069, "lon": 85.2877 },
        { "name": "Halchowk", "district": "Kathmandu", "area": "Halchowk", "lat": 27.6994, "lon": 85.2742 },
        { "name": "Pepsicola", "district": "Kathmandu", "area": "Pepsicola", "lat": 27.6841, "lon": 85.3784 },
       { "name": "Manamaiju", "district": "Kathmandu", "area": "Manamaiju", "lat": 27.7628, "lon": 85.3200 },
        { "name": "Dallu", "district": "Kathmandu", "area": "Dallu", "lat": 27.7136, "lon": 85.2884 },
        { "name": "Gyaneshwor", "district": "Kathmandu", "area": "Gyaneshwor", "lat": 27.7166, "lon": 85.3308 },
        { "name": "Dhalko", "district": "Kathmandu", "area": "Dhalko", "lat": 27.7093, "lon": 85.3087 },
      { "name": "Dhungedhara", "district": "Kathmandu", "area": "Dhungedhara", "lat": 27.7076, "lon": 85.2991 },
       { "name": "Kausaltar", "district": "Bhaktapur", "area": "Kausaltar", "lat": 27.6789, "lon": 85.4284 },
        { "name": "Sallaghari", "district": "Bhaktapur", "area": "Sallaghari", "lat": 27.6870, "lon": 85.4246 },
     { "name": "Jagati", "district": "Bhaktapur", "area": "Jagati", "lat": 27.6693, "lon": 85.4392 },
     { "name": "Bode", "district": "Bhaktapur", "area": "Bode", "lat": 27.6841, "lon": 85.4034 },
    { "name": "Thimi", "district": "Bhaktapur", "area": "Thimi", "lat": 27.6800, "lon": 85.4051 },
      { "name": "Suryabinayak", "district": "Bhaktapur", "area": "Suryabinayak", "lat": 27.6698, "lon": 85.4252 },
       { "name": "Lokanthali", "district": "Bhaktapur", "area": "Lokanthali", "lat": 27.6921, "lon": 85.3989 },
       { "name": "Madhyapur Thimi", "district": "Bhaktapur", "area": "Thimi", "lat": 27.6783, "lon": 85.4103 },
        { "name": "Changu Narayan", "district": "Bhaktapur", "area": "Changu Narayan", "lat": 27.7092, "lon": 85.4155 },
    { "name": "Nagarkot", "district": "Bhaktapur", "area": "Nagarkot", "lat": 27.7198, "lon": 85.5027 },
         { "name": "Bungamati", "district": "Lalitpur", "area": "Bungamati", "lat": 27.6511, "lon": 85.3147 },
        { "name": "Khokana", "district": "Lalitpur", "area": "Khokana", "lat": 27.6473, "lon": 85.3072 },
     { "name": "Godawari", "district": "Lalitpur", "area": "Godawari", "lat": 27.5788, "lon": 85.3612 },
     { "name": "Harisiddhi", "district": "Lalitpur", "area": "Harisiddhi", "lat": 27.6461, "lon": 85.3273 },
     { "name": "Lubhu", "district": "Lalitpur", "area": "Lubhu", "lat": 27.6280, "lon": 85.3741 },
        { "name": "Sundarighat", "district": "Lalitpur", "area": "Sundarighat", "lat": 27.6788, "lon": 85.3345 },
      { "name": "Lele", "district": "Lalitpur", "area": "Lele", "lat": 27.5927, "lon": 85.3815 },
        { "name": "Taukhel", "district": "Lalitpur", "area": "Taukhel", "lat": 27.6205, "lon": 85.2842 },
         { "name": "Panga", "district": "Kirtipur", "area": "Panga", "lat": 27.6760, "lon": 85.2708 },
     { "name": "Balkot", "district": "Bhaktapur", "area": "Balkot", "lat": 27.6671, "lon": 85.3877 },
       { "name": "Siddhipur", "district": "Lalitpur", "area": "Siddhipur", "lat": 27.6426, "lon": 85.3420 },
    { "name": "Gundu", "district": "Bhaktapur", "area": "Gundu", "lat": 27.6943, "lon": 85.4261 },
     { "name": "Nangkhel", "district": "Bhaktapur", "area": "Nangkhel", "lat": 27.6847, "lon": 85.4324 },
     { "name": "Sirutar", "district": "Bhaktapur", "area": "Sirutar", "lat": 27.7183, "lon": 85.4251 },
       { "name": "Mulpani", "district": "Kathmandu", "area": "Mulpani", "lat": 27.7380, "lon": 85.3793 },
        { "name": "Tokha", "district": "Kathmandu", "area": "Tokha", "lat": 27.7583, "lon": 85.3192 },
     { "name": "Kageshwori Manohara", "district": "Kathmandu", "area": "Kageshwori", "lat": 27.7262, "lon": 85.3893 },
     { "name": "Bhimdhunga", "district": "Kathmandu", "area": "Bhimdhunga", "lat": 27.7407, "lon": 85.2697 },
        { "name": "Nepalgunj", "district": "Kathmandu", "area":"Nepalgunj","lat": 27.7338, "lon": 85.2867},
        { "name": "Luvu", "district": "Lalitpur", "area":"Luvu", "lat":27.6153, "lon": 85.3731},
        { "name":"Gothikhel", "district":"Lalitpur", "area":"Gothikhel", "lat":27.6072, "lon": 85.4223},
        { "name":"Jaisidewal", "district":"Kathmandu", "area":"City Center", "lat":27.7049, "lon":85.3101},
        { "name":"Pipalbot", "district":"Kathmandu", "area":"Pipalbot","lat":27.7048, "lon":85.3136},
        { "name":"Mahankal", "district":"Kathmandu", "area":"Mahankal", "lat":27.7162, "lon":85.3100},
         { "name":"Naya Thimi", "district":"Bhaktapur", "area":"Thimi","lat":27.6795, "lon":85.4073},
        { "name":"Nakhipot", "district":"Lalitpur", "area":"Nakhipot", "lat":27.6819, "lon":85.3068},
          { "name":"Bhaktapur Durbar Square", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6716, "lon":85.4278},
        { "name":"Patan Durbar Square", "district":"Lalitpur", "area":"Patan","lat":27.6726, "lon":85.3204},
        { "name":"Bhaktapur Bus Park", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6762, "lon":85.4290},
         { "name":"New Bus Park", "district":"Kathmandu", "area":"Gongabu","lat":27.7384, "lon":85.3069},
        { "name":"Old Bus Park", "district":"Kathmandu", "area":"City Center", "lat":27.7030, "lon":85.3144},
         { "name":"Machha Pokhari", "district":"Kathmandu", "area":"Machha Pokhari","lat":27.7149, "lon":85.3031},
        { "name":"Shantinagar", "district":"Kathmandu", "area":"Baneshwor","lat":27.6902, "lon":85.3364},
            { "name":"Buddha Park (Baneshwor)", "district":"Kathmandu", "area":"Baneshwor", "lat":27.6919, "lon":85.3389},
        { "name":"Balaju Park", "district":"Kathmandu", "area":"Balaju","lat":27.7386, "lon":85.3006},
        { "name":"Godawari Botanical Garden", "district":"Lalitpur", "area":"Godawari", "lat":27.5774, "lon":85.3574},
        { "name":"Tribhuvan International Airport", "district":"Kathmandu", "area":"Sinamangal","lat":27.6958, "lon":85.3580},
        { "name":"Nepal Academy of Science and Technology", "district":"Lalitpur", "area":"Khumaltar","lat":27.6620, "lon":85.3039},
        { "name":"Tribhuvan University", "district":"Kathmandu", "area":"Kirtipur","lat":27.6894, "lon":85.2819},
        { "name":"Kathmandu Engineering College", "district":"Kathmandu", "area":"Kalanki","lat":27.6964, "lon":85.2822},
        { "name":"United Academy", "district":"Kathmandu", "area":"Kumaripati","lat":27.6735, "lon":85.3178},
        { "name":"Kantipur Engineering College", "district":"Lalitpur", "area":"Dhapakhel", "lat":27.6203, "lon":85.3816},
        { "name":"Kathmandu Model College", "district":"Kathmandu", "area":"Bagbazar","lat":27.7096, "lon":85.3155},



        { "name": "Kathmandu Model College", "district": "Kathmandu", "area": "Bagbazar", "lat": 27.7096, "lon": 85.3155 },
        { "name": "Tri-Chandra Multiple Campus", "district": "Kathmandu", "area": "City Center", "lat": 27.7021, "lon": 85.3164 },
        { "name": "National Trading Limited", "district": "Kathmandu", "area": "Teku", "lat": 27.6944, "lon": 85.3062 },
        { "name": "Bir Hospital", "district": "Kathmandu", "area": "City Center", "lat": 27.7061, "lon": 85.3178 },
        { "name": "Teaching Hospital (Maharajgunj)", "district": "Kathmandu", "area": "Maharajgunj", "lat": 27.7375, "lon": 85.3382 },
        { "name": "Civil Hospital", "district": "Kathmandu", "area": "Minbhawan", "lat": 27.6898, "lon": 85.3427 },
        { "name": "Shahid Gangalal National Heart Center", "district": "Kathmandu", "area": "Bansbari", "lat": 27.7398, "lon": 85.3361 },
        { "name": "Eye Hospital", "district": "Kathmandu", "area": "Tripureshwor", "lat": 27.6981, "lon": 85.3126 },
        { "name": "Maternity Hospital (Thapathali)", "district": "Kathmandu", "area": "Thapathali", "lat": 27.6942, "lon": 85.3145 },
        { "name": "Norvic Hospital", "district": "Kathmandu", "area": "Thapathali", "lat": 27.6938, "lon": 85.3207 },
        { "name": "Grande Hospital", "district": "Kathmandu", "area": "Dhapakhel", "lat": 27.7263, "lon": 85.3244},
        { "name": "B and B Hospital", "district": "Lalitpur", "area": "Gwarko", "lat": 27.6610, "lon": 85.3249 },
        { "name": "Vayodha Hospital", "district": "Kathmandu", "area": "Balkhu", "lat": 27.6922, "lon": 85.2903 },
         { "name": "Om Hospital", "district": "Kathmandu", "area": "Chabahil", "lat": 27.7238, "lon": 85.3474 },
        { "name": "Star Hospital", "district": "Kathmandu", "area": "Sanepa", "lat": 27.6813, "lon": 85.3078 },
        { "name": "Nepal Police Hospital", "district": "Kathmandu", "area": "Maharajgunj", "lat": 27.7351, "lon": 85.3316 },
        { "name": "Armed Police Force Hospital", "district": "Kathmandu", "area": "Balambu", "lat": 27.7033, "lon": 85.2747 },
        { "name": "Army Hospital", "district": "Kathmandu", "area": "Chhauni", "lat": 27.7048, "lon": 85.2937 },
        { "name": "Singha Durbar", "district": "Kathmandu", "area": "City Center", "lat": 27.6988, "lon": 85.3215 },
        { "name": "Supreme Court of Nepal", "district": "Kathmandu", "area": "City Center", "lat": 27.7006, "lon": 85.3197 },
        { "name": "Parliament of Nepal", "district": "Kathmandu", "area": "Singha Durbar", "lat": 27.6984, "lon": 85.3206 },
        { "name": "National Planning Commission", "district": "Kathmandu", "area": "Singha Durbar", "lat": 27.6983, "lon": 85.3218 },
        { "name": "Election Commission of Nepal", "district": "Kathmandu", "area": "City Center", "lat": 27.7016, "lon": 85.3252 },
        { "name": "Department of Roads", "district": "Kathmandu", "area": "Babar Mahal", "lat": 27.6899, "lon": 85.3244 },
        { "name": "Kathmandu Metropolitan City Office", "district": "Kathmandu", "area": "City Center", "lat": 27.7051, "lon": 85.3157 },
        { "name": "Nepal Rastra Bank", "district": "Kathmandu", "area": "Baluwatar", "lat": 27.7181, "lon": 85.3235 },
       { "name": "Investment Board Nepal", "district": "Kathmandu", "area": "City Center", "lat": 27.7063, "lon": 85.3212 },
        { "name": "Salt Trading Corporation", "district": "Kathmandu", "area": "Kalimati", "lat": 27.6927, "lon": 85.2999 },
         { "name": "Sajha Yatayat", "district": "Kathmandu", "area": "Pulchowk", "lat": 27.6799, "lon": 85.3141 },
        { "name": "Nepal Telecom Office", "district": "Kathmandu", "area": "Bhadrakali", "lat": 27.7009, "lon": 85.3181 },
        { "name": "Nepal Electricity Authority Office", "district": "Kathmandu", "area": "Ratna Park", "lat": 27.7035, "lon": 85.3170 },
        { "name": "Nepal Oil Corporation", "district": "Kathmandu", "area": "Babarmahal", "lat": 27.6921, "lon": 85.3231 },
        { "name": "Rastriya Samachar Samiti", "district": "Kathmandu", "area": "City Center", "lat": 27.7010, "lon": 85.3166 },
        { "name": "Radio Nepal", "district": "Kathmandu", "area": "Singha Durbar", "lat": 27.6978, "lon": 85.3211 },
        { "name": "Nepal Television", "district": "Kathmandu", "area": "Singha Durbar", "lat": 27.6980, "lon": 85.3231 },
        { "name": "Gorkhapatra Corporation", "district": "Kathmandu", "area": "New Road", "lat": 27.7047, "lon": 85.3173 },
        { "name": "Ratopul", "district": "Kathmandu", "area":"Gausala","lat": 27.7090, "lon": 85.3571 },
        { "name": "Naya Bato", "district": "Kathmandu", "area": "Naya Bato", "lat": 27.7077, "lon": 85.3018 },
       { "name": "Kalopul", "district": "Kathmandu", "area":"Kalopul", "lat":27.7306, "lon":85.3466},
        { "name": "Mahadevsthan", "district": "Kathmandu", "area": "Mahadevsthan", "lat": 27.7133, "lon": 85.3132 },
        { "name": "Sankha Park", "district":"Kathmandu", "area":"Maharajgunj","lat":27.7338, "lon":85.3358},
        { "name": "Nagarjun Forest", "district": "Kathmandu", "area": "Northwest Kathmandu", "lat": 27.7363, "lon": 85.2674 },
        { "name": "Shivapuri National Park", "district": "Kathmandu", "area": "North Kathmandu", "lat": 27.7748, "lon": 85.3864 },
        { "name": "Swayambhu Hill", "district":"Kathmandu", "area":"Swoyambhu","lat": 27.7144, "lon": 85.2891 },
        { "name": "Nagdaha", "district": "Lalitpur", "area": "Nagdaha", "lat": 27.6400, "lon": 85.3711 },
     { "name": "Tau Daha", "district": "Kathmandu", "area": "Kirtipur", "lat": 27.6748, "lon": 85.2684 },
       { "name": "Ranipokhari", "district": "Kathmandu", "area": "City Center", "lat": 27.7046, "lon": 85.3139 },
     { "name": "Siddha Pokhari", "district": "Bhaktapur", "area": "Bhaktapur", "lat": 27.6708, "lon": 85.4287 },
        { "name":"Kamal Pokhari", "district":"Kathmandu", "area":"Kamal Pokhari","lat": 27.7118, "lon":85.3294},
        { "name":"Bhairav Kund", "district":"Sindhupalchok","area":"NorthEast Kathmandu","lat":27.8755,"lon":85.8107},
         { "name": "Gokarna Forest", "district": "Kathmandu", "area": "Gokarna", "lat": 27.7329, "lon": 85.4067 },
       { "name": "Ichangu Narayan", "district":"Kathmandu","area":"Ichangu Narayan", "lat": 27.7216,"lon":85.2755},
        { "name": "Bajrayogini Temple", "district":"Sankhu", "area":"Bajrayogini","lat": 27.7246, "lon": 85.4487 },
        { "name": "Changu Narayan Temple", "district":"Bhaktapur", "area":"Changu Narayan","lat":27.7093, "lon":85.4156},
        { "name": "Dakshinkali Temple", "district":"Kathmandu","area":"Dakshinkali","lat":27.6442, "lon":85.2821},
       { "name": "Guheshwari Temple", "district":"Kathmandu","area":"Pashupati","lat":27.7088, "lon": 85.3533 },
   { "name":"Bagmati River", "district":"Kathmandu","area":"Kathmandu Valley", "lat":27.6839, "lon":85.3380},
    { "name": "Bishnumati River", "district":"Kathmandu","area":"Kathmandu Valley", "lat":27.7152, "lon":85.3017},
   { "name":"Manohara River", "district":"Kathmandu","area":"Kathmandu Valley","lat":27.6853, "lon":85.3712},
    { "name":"Tukucha River", "district":"Kathmandu","area":"Kathmandu Valley","lat":27.7032,"lon":85.3168},
    { "name":"Khaste Chaur", "district":"Kathmandu","area":"Khaste Chaur","lat":27.7168, "lon":85.3625},
   { "name": "Bhadrakali Temple", "district":"Kathmandu","area":"City Center","lat":27.7002, "lon":85.3177},
    { "name":"Rato Machhindranath Temple (Patan)", "district":"Lalitpur", "area":"Patan","lat":27.6688, "lon":85.3196},
     { "name":"Seto Machhindranath Temple", "district":"Kathmandu","area":"City Center","lat":27.7097, "lon":85.3133},
    { "name":"Taleju Temple", "district":"Kathmandu", "area":"City Center","lat":27.7038, "lon":85.3118},
    { "name":"Jaya Bageshwari Temple", "district":"Kathmandu","area":"Pashupati","lat":27.7088, "lon":85.3545},
     { "name":"Indrayani Temple", "district":"Kathmandu", "area":"Indrayani","lat":27.7120, "lon":85.2921},
    { "name":"Maitidevi Temple", "district":"Kathmandu","area":"Maitidevi","lat":27.7188,"lon":85.3421},
   { "name":"Ganesh Temple (various locations)", "district":"Kathmandu","area":"Various locations","lat":27.7064, "lon":85.3175},
     { "name": "Saraswati Temple (various locations)", "district":"Kathmandu", "area":"Various locations","lat":27.7030, "lon":85.3202 },
    { "name":"Bhimsen Temple", "district":"Kathmandu", "area":"City Center","lat":27.7062, "lon":85.3127},
     { "name":"Krishna Mandir (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6726, "lon":85.3198},
     { "name":"Hiranya Varna Mahavihar", "district":"Lalitpur", "area":"Patan","lat":27.6724, "lon":85.3175},
     { "name":"Kumbheshwar Temple", "district":"Lalitpur","area":"Patan","lat":27.6703, "lon":85.3241},
     { "name":"Mahaboudha Temple", "district":"Lalitpur","area":"Patan","lat":27.6729,"lon":85.3222},
    { "name":"Jagannath Temple", "district":"Kathmandu", "area":"City Center", "lat": 27.7042, "lon": 85.3114 },
     { "name":"Gauri Shankar Temple", "district":"Kathmandu","area":"City Center","lat":27.7039, "lon":85.3111},
    { "name":"Ashok Stupa (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6725, "lon":85.3184},
     { "name":"Four Stupas (Patan)", "district":"Lalitpur", "area":"Patan","lat":27.6726, "lon":85.3184},
    { "name":"Golden Temple (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6708, "lon":85.3183},
    { "name":"Nyatapola Temple (Bhaktapur)", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6702,"lon":85.4276},
    { "name":"Dattatreya Temple (Bhaktapur)", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6718,"lon":85.4288},
      { "name":"Vatsala Durga Temple (Bhaktapur)", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6718, "lon":85.4278},
    { "name":"Bhairava Nath Temple (Bhaktapur)", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6720,"lon":85.4276},
    { "name":"Siddha Pokhari (Bhaktapur)", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6708, "lon":85.4284},
    { "name":"Siddhakali Temple (Bhaktapur)", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6645, "lon":85.4241},
     { "name":"Telia Chok", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6752, "lon":85.4314},
    { "name":"Lamatar", "district":"Lalitpur", "area":"Lamatar", "lat":27.6336, "lon":85.4260},
      { "name":"Panauti", "district":"Kabhrepalanchok", "area":"Panauti","lat":27.6081, "lon":85.5045},
    { "name":"Budhabare", "district":"Bhaktapur","area":"Budhabare","lat":27.7003,"lon":85.4665},
     { "name":"Khahare", "district":"Kathmandu", "area":"Khahare","lat":27.7050,"lon":85.2618},
    { "name":"Phulchoki", "district":"Lalitpur","area":"Phulchoki", "lat":27.6219,"lon":85.3847},
    { "name":"Lubu Bazar", "district":"Lalitpur", "area":"Lubu", "lat":27.6283, "lon":85.3755},
      { "name":"Sunakothi", "district":"Lalitpur","area":"Sunakothi","lat":27.6330,"lon":85.3292},
      { "name":"Sisdol", "district":"Kathmandu","area":"Sisdol","lat":27.7361, "lon":85.2525},
     { "name":"Sanga", "district":"Kavrepalanchok","area":"Sanga","lat":27.6162,"lon":85.4857},
     { "name":"Dhulikhel", "district":"Kavrepalanchok","area":"Dhulikhel","lat":27.6121,"lon":85.5507},
    { "name":"Panchkhal", "district":"Kavrepalanchok", "area":"Panchkhal","lat":27.6679,"lon":85.6227},
   { "name":"Bahrabise", "district":"Sindhupalchok","area":"Bahrabise", "lat":27.7063,"lon":85.7615},
   { "name":"Melamchi", "district":"Sindhupalchok","area":"Melamchi","lat":27.8308, "lon":85.5906},
  { "name":"Jiri", "district":"Dolakha","area":"Jiri","lat":27.6341,"lon":86.2264},
    { "name":"Charikot", "district":"Dolakha","area":"Charikot","lat":27.6605,"lon":85.9938},
    { "name":"Sunkoshi", "district":"Sindhupalchok","area":"Sunkoshi", "lat":27.5651, "lon":85.8264},
     { "name":"Kalinchok", "district":"Dolakha","area":"Kalinchok","lat":27.7885,"lon":85.9952},
    { "name":"Ghyampe Danda", "district":"Bhaktapur", "area":"Ghyampe Danda", "lat":27.7009,"lon":85.4539},
    { "name":"Chandragiri Hills", "district":"Kathmandu","area":"Chandragiri","lat":27.6986,"lon":85.2409},
    { "name":"Pharping Dakshinkali", "district":"Kathmandu", "area":"Pharping","lat":27.6445, "lon":85.2580},
      { "name":"Chobhar Gorge", "district":"Kathmandu", "area":"Chobhar","lat":27.6767,"lon":85.2940},
    { "name":"Hattiban", "district":"Lalitpur", "area":"Hattiban", "lat":27.6556, "lon":85.3077},
    { "name":"Bajrabarahi Temple", "district":"Lalitpur","area":"Bajrabarahi","lat":27.5798, "lon":85.2961},
     { "name":"Dhakaltar", "district":"Kathmandu", "area":"Dhakaltar","lat":27.6954, "lon":85.2802},
     { "name":"Mudkhu", "district":"Kathmandu","area":"Mudkhu", "lat":27.7784,"lon":85.2739},
    { "name":"Balambu", "district":"Kathmandu","area":"Balambu", "lat":27.6995,"lon":85.2756},
     { "name":"Makkhan", "district":"Kathmandu","area":"City Center", "lat":27.7047,"lon":85.3105},
    { "name":"Yatkha", "district":"Kathmandu","area":"City Center","lat":27.7072, "lon":85.3099},
    { "name":"Kwabahal", "district":"Kathmandu","area":"City Center","lat":27.7057, "lon":85.3079},
    { "name":"Mahapal", "district":"Kathmandu","area":"City Center","lat":27.7084, "lon":85.3137},
    { "name":"Hakuwa", "district":"Kathmandu","area":"City Center", "lat":27.7068, "lon":85.3094},
     { "name":"Wotu", "district":"Kathmandu","area":"City Center", "lat":27.7057,"lon":85.3092},
     { "name":"Itum Bahal", "district":"Kathmandu","area":"City Center", "lat":27.7056, "lon":85.3088},
    { "name":"Kohiti", "district":"Kathmandu","area":"City Center","lat":27.7047, "lon":85.3107},
     { "name":"Bramhatole", "district":"Kathmandu", "area":"City Center","lat":27.7057, "lon":85.3122},
     { "name":"Naya Tol", "district":"Kathmandu","area":"City Center","lat":27.7065,"lon":85.3123},
      { "name":"Chyasal", "district":"Lalitpur", "area":"Patan", "lat":27.6713, "lon":85.3174},
        { "name":"Patuko", "district":"Lalitpur","area":"Patan","lat":27.6698, "lon":85.3155},
      { "name":"Sundhara (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6693,"lon":85.3185},
      { "name":"Mangal Bazar", "district":"Lalitpur", "area":"Patan","lat":27.6722, "lon":85.3188},
     { "name":"Gabahal", "district":"Lalitpur", "area":"Patan", "lat":27.6692,"lon":85.3197},
     { "name":"Pulchowk (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6794,"lon":85.3142},
    { "name":"Kupondole (Patan)", "district":"Lalitpur","area":"Patan","lat":27.6816, "lon":85.3173},
    { "name":"Lagankhel (Patan)", "district":"Lalitpur","area":"Patan", "lat":27.6725, "lon":85.3209},
   { "name":"Gwarko (Patan)", "district":"Lalitpur","area":"Gwarko", "lat":27.6622, "lon":85.3280},
   { "name":"Dhokaima", "district":"Lalitpur","area":"Patan","lat":27.6735, "lon":85.3230},
    { "name":"Chibaha", "district":"Lalitpur","area":"Patan","lat":27.6698,"lon":85.3216},
    { "name":"Thecho", "district":"Lalitpur","area":"Thecho","lat":27.6236, "lon":85.3037},
    { "name":"Chapali", "district":"Kathmandu", "area":"Chapali", "lat":27.7672, "lon":85.3333},
    { "name":"Sundar Basti", "district":"Kathmandu","area":"Sundar Basti", "lat":27.7269,"lon":85.3724},
     { "name":"Bungamati Bazar", "district":"Lalitpur","area":"Bungamati","lat":27.6509, "lon":85.3141},
    { "name":"Panga Bazar", "district":"Kirtipur","area":"Panga","lat":27.6770,"lon":85.2671},
    { "name":"Chunikhel", "district":"Kathmandu","area":"Chunikhel","lat":27.7576, "lon":85.3704},
     { "name":"Sunakothi", "district":"Lalitpur","area":"Sunakothi","lat":27.6322, "lon":85.3293},
       { "name":"Imadol Chowk", "district":"Lalitpur","area":"Imadol", "lat":27.6587, "lon":85.3453},
    { "name":"Bhaisepati Chowk", "district":"Lalitpur", "area":"Bhaisepati","lat":27.6646, "lon":85.2921},
    { "name":"Harisiddhi Chowk", "district":"Lalitpur", "area":"Harisiddhi", "lat":27.6444, "lon":85.3271},
        { "name":"Lubhu Chowk", "district":"Lalitpur", "area":"Lubhu", "lat":27.6276, "lon":85.3727},
    { "name":"Godawari Chowk", "district":"Lalitpur", "area":"Godawari","lat":27.5795, "lon":85.3613},
   { "name":"Chapagaun Chowk", "district":"Lalitpur","area":"Chapagaun","lat":27.5936, "lon":85.3204},
    { "name":"Thaiba", "district":"Lalitpur","area":"Thaiba","lat":27.6564, "lon":85.3013},
  { "name":"Kitini", "district":"Lalitpur","area":"Kitini","lat":27.6204,"lon":85.3546},
  { "name":"Patan Dhoka", "district":"Lalitpur", "area":"Patan","lat":27.6717, "lon":85.3193},
     { "name":"Thimi Durbar Square", "district":"Bhaktapur","area":"Thimi","lat":27.6804,"lon":85.4068},
   { "name":"Kamal Binayak", "district":"Bhaktapur","area":"Bhaktapur", "lat":27.6783, "lon":85.4251},
   { "name":"Potthari", "district":"Bhaktapur", "area":"Bhaktapur","lat":27.6804, "lon":85.4234},
    { "name":"Byasi", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6731,"lon":85.4195},
     { "name":"Nagadesh", "district":"Bhaktapur","area":"Bhaktapur", "lat":27.6748, "lon":85.4031},
       { "name":"Itache", "district":"Bhaktapur","area":"Bhaktapur","lat":27.6789,"lon":85.4284},
    { "name":"Taumadhi Square", "district":"Bhaktapur","area":"Bhaktapur", "lat":27.6706, "lon":85.4269},
     { "name":"Dattatraya Square", "district":"Bhaktapur","area":"Bhaktapur", "lat":27.6719, "lon":85.4283},
      { "name":"Suryamadhi", "district":"Bhaktapur","area":"Bhaktapur", "lat":27.6714, "lon":85.4265},
  { "name":"Bolachhe", "district":"Bhaktapur", "area":"Bhaktapur", "lat":27.6684, "lon":85.4226},
    { "name":"Bhajungal", "district":"Bhaktapur", "area":"Bhaktapur", "lat":27.6662, "lon":85.4301},
       { "name":"Chhampi", "district":"Lalitpur","area":"Chhampi", "lat":27.6401, "lon":85.2770},
    { "name":"Sudal", "district":"Bhaktapur","area":"Sudal", "lat":27.6932, "lon":85.4176},
       { "name":"Thalachhen", "district":"Bhaktapur", "area":"Thalachhen","lat":27.6881,"lon":85.4310},
    { "name":"Chaling", "district":"Bhaktapur", "area":"Chaling","lat":27.6763, "lon":85.4368},
    { "name":"Sipadol", "district":"Bhaktapur","area":"Sipadol","lat":27.6712, "lon":85.4485},
     { "name":"Tathali", "district":"Bhaktapur", "area":"Tathali","lat":27.6802, "lon":85.4638},
    { "name":"Katuwa", "district":"Bhaktapur", "area":"Katuwa","lat":27.6856, "lon":85.4349},
   { "name":"Palase", "district":"Bhaktapur","area":"Palase","lat":27.6830, "lon":85.4559},
   { "name":"Patalekhet", "district":"Bhaktapur","area":"Patalekhet","lat":27.7107, "lon":85.4642},
   { "name":"Jhaukhel", "district":"Bhaktapur","area":"Jhaukhel", "lat":27.6746,"lon":85.4128},
  { "name": "Baneshwor Chowk", "district": "Kathmandu", "area": "Baneshwor", "lat": 27.6931, "lon": 85.3345 },
{ "name": "Tinkune Chowk", "district": "Kathmandu", "area": "Koteshwor", "lat": 27.6758, "lon": 85.3444 },
{ "name": "Gwarko Chowk", "district": "Lalitpur", "area": "Gwarko", "lat": 27.6627, "lon": 85.3283 }


    // Add more local chowks and landmarks here
];

// Update the search function to better handle local areas
async function searchAddress(query) {
    const suggestionsDiv = document.getElementById('addressSuggestions');
    query = query.toLowerCase().trim();

    if (query.length < 2) {
        suggestionsDiv.style.display = 'none';
        return;
    }

    // Filter locations based on search query
    const filteredLocations = predefinedLocations.filter(loc => 
        loc.name.toLowerCase().includes(query) ||
        loc.area.toLowerCase().includes(query) ||
        loc.district.toLowerCase().includes(query)
    );

    if (filteredLocations.length > 0) {
        suggestionsDiv.innerHTML = filteredLocations
            .map(loc => `
                <div class="suggestion-item" 
                     onclick="selectLocation('${loc.name}, ${loc.area}, ${loc.district}', ${loc.lat}, ${loc.lon})">
                    <div class="location-name">${loc.name}</div>
                    <div class="location-detail">${loc.area}, ${loc.district}</div>
                </div>
            `)
            .join('');
        suggestionsDiv.style.display = 'block';
        document.getElementById('map').style.display = 'none'; // Hide map when showing suggestions
    } else {
        // When no results found, hide suggestions and show map
        suggestionsDiv.style.display = 'none';
        
        // Show and initialize map
        const mapDiv = document.getElementById('map');
        mapDiv.style.display = 'block';
        
        if (!map) {
            initMap();
        }
        
        // Center map on Kathmandu Valley
        const kathmanduCenter = [27.7172, 85.3240];
        map.setView(kathmanduCenter, 13);
        
        // Add or move marker
        if (marker) {
            marker.setLatLng(kathmanduCenter);
        } else {
            marker = L.marker(kathmanduCenter, {draggable: true}).addTo(map);
        }
        
        // Update address when marker is dragged
        marker.on('dragend', function(e) {
            const position = e.target.getLatLng();
            updateAddress(position.lat, position.lng);
        });
        
        // Allow clicking on map to move marker
        map.on('click', function(e) {
            const position = e.latlng;
            marker.setLatLng(position);
            updateAddress(position.lat, position.lng);
        });

        // Show small notification
        const notification = document.createElement('div');
        notification.className = 'map-notification';
        notification.innerHTML = 'Click on the map to set your location';
        document.querySelector('.address-group').appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }
}

function selectLocation(address, lat, lon) {
    document.getElementById('address').value = address;
    document.getElementById('addressSuggestions').style.display = 'none';
    
    // Store coordinates
    selectedLatitude = lat;
    selectedLongitude = lon;
    
    // Show map and hint
    const mapDiv = document.getElementById('map');
    const mapHint = document.querySelector('.map-hint');
    mapDiv.style.display = 'block';
    mapHint.style.display = 'block';
    
    if (!map) {
        initMap();
    }
    
    map.setView([lat, lon], 16);
    
    if (marker) {
        marker.remove();
    }
    
    marker = L.marker([lat, lon], {draggable: true}).addTo(map);
    
    // Update coordinates when marker is dragged
    marker.on('dragend', function(e) {
        const position = e.target.getLatLng();
        selectedLatitude = position.lat;
        selectedLongitude = position.lng;
        updateAddress(position.lat, position.lng);
    });
    
    // Update coordinates when map is clicked
    map.on('click', function(e) {
        const position = e.latlng;
        selectedLatitude = position.lat;
        selectedLongitude = position.lng;
        marker.setLatLng(position);
        updateAddress(position.lat, position.lng);
    });
}

async function updateAddress(lat, lng) {
    try {
        selectedLatitude = lat;
        selectedLongitude = lng;
        
        const response = await fetch(
            `https://nominatim.openstreetmap.org/reverse?` +
            `format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`
        );
        const data = await response.json();
        
        // Update the address input with the new location
        const address = data.display_name;
        document.getElementById('address').value = address;
    } catch (error) {
        console.error('Error updating address:', error);
    }
}

// Initialize when document is ready
document.addEventListener('DOMContentLoaded', () => {
    const addressInput = document.getElementById('address');
    const debouncedSearch = debounce(searchAddress, 300);
    
    addressInput.addEventListener('input', (e) => {
        debouncedSearch(e.target.value);
    });
    
    // Close suggestions when clicking outside
    document.addEventListener('click', (e) => {
        if (!addressInput.contains(e.target) && 
            !document.getElementById('addressSuggestions').contains(e.target)) {
            document.getElementById('addressSuggestions').style.display = 'none';
        }
    });
});

function downloadAgreement() {
    const teacherName = document.getElementById('fullName').value || '[Teacher Name]';
    const currentDate = new Date().toLocaleDateString('en-NP');
    
    const agreementContent = `
Teacher Agreement

Date: ${currentDate}

This agreement is made between:
Teacher Name: ${teacherName}
Company:Dear Sir Home Tuition 

1. Responsibilities of the Tutor
The Tutor agrees to:
- Provide high-quality teaching tailored to the needs of the student(s)
- Be punctual and professional in all interactions
- Maintain confidentiality of all student-related information
- Report progress to the Company or parents, as required

2. Initial Fee Payment by the Tutor
The Tutor agrees to pay 30% of the first month's tuition fee to the Company before commencing teaching.

3. Confidentiality
The Tutor agrees not to disclose any confidential information regarding the Company, students, or parents without prior consent from the Company.

4. Crime Responsibility
The Tutor agrees to conduct themselves in a lawful, ethical, and professional manner at all times during their teaching assignments.
Any crime, illegal activity, or misconduct committed by the Tutor during the course of their teaching duties will be solely their responsibility. The Company shall not be held liable for such actions.

5. Code of Conduct
The Tutor agrees to abide by the Company's code of conduct, including but not limited to:
- Maintaining a respectful and safe environment for students
- Avoiding conflicts of interest or private agreements with clients

6. Dispute Resolution
Any disputes arising from this agreement will be resolved through mutual discussion. If unresolved, the matter may be referred to mediation or arbitration in accordance with Nepalese law.

7. The tutor declare that all the information provided in this application is true and correct.

Signature: ${teacherName}
Date: ${currentDate}
    `;
    
    // Create blob and download
    const blob = new Blob([agreementContent], { type: 'text/plain' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Teacher_Agreement_${teacherName.replace(/\s+/g, '_')}_${currentDate.replace(/\//g, '-')}.txt`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
    
    // Auto-check the download confirmation checkbox
    document.getElementById('confirmDownload').checked = true;
}
</script>



</body>
</html>